# ğŸ”§ Manual SQL Migration Required

**Date**: August 13, 2025  
**Priority**: CRITICAL - Blocking workflow creation

## ğŸ“‹ SQL to Execute in Supabase Dashboard

### Step 1: Access SQL Editor
Go to: https://supabase.com/dashboard/project/zfbgdixbzezpxllkoyfc/sql/new

### Step 2: Run This SQL

```sql
-- Add missing webhook_url column
ALTER TABLE mvp_workflows 
ADD COLUMN IF NOT EXISTS webhook_url TEXT;

-- Add missing sync columns (if not present)
ALTER TABLE mvp_workflows 
ADD COLUMN IF NOT EXISTS sync_status TEXT DEFAULT 'pending';

ALTER TABLE mvp_workflows 
ADD COLUMN IF NOT EXISTS last_sync_at TIMESTAMP WITH TIME ZONE;

-- Create performance indexes
CREATE INDEX IF NOT EXISTS idx_mvp_workflows_user_id 
ON mvp_workflows(user_id);

CREATE INDEX IF NOT EXISTS idx_mvp_workflows_n8n_workflow_id 
ON mvp_workflows(n8n_workflow_id);

CREATE INDEX IF NOT EXISTS idx_mvp_workflows_sync_status 
ON mvp_workflows(sync_status);

-- Add helpful comments
COMMENT ON COLUMN mvp_workflows.webhook_url 
IS 'The webhook URL generated by n8n for this workflow';

COMMENT ON COLUMN mvp_workflows.sync_status 
IS 'Synchronization status between Supabase and n8n';

COMMENT ON COLUMN mvp_workflows.last_sync_at 
IS 'Timestamp of the last synchronization';

-- Verify the changes
SELECT column_name, data_type, is_nullable, column_default
FROM information_schema.columns
WHERE table_name = 'mvp_workflows'
AND column_name IN ('webhook_url', 'sync_status', 'last_sync_at')
ORDER BY column_name;
```

### Step 3: Verify Results

After running, you should see:
- âœ… webhook_url column added
- âœ… sync_status column added  
- âœ… last_sync_at column added
- âœ… Performance indexes created

## ğŸ“Š Current Table Status

**Already Present** (verified by script):
- âœ… id
- âœ… user_id
- âœ… project_id
- âœ… name
- âœ… description
- âœ… n8n_workflow_id
- âœ… n8n_workflow_json
- âœ… original_prompt
- âœ… status
- âœ… version
- âœ… deployment_status
- âœ… deployment_url
- âœ… deployment_error
- âœ… last_deployed_at
- âœ… execution_count
- âœ… last_execution_at
- âœ… avg_execution_time_ms
- âœ… created_at
- âœ… updated_at

**Missing** (needs manual addition):
- âŒ webhook_url (CRITICAL)
- âŒ sync_status (for 2-way sync)
- âŒ last_sync_at (for 2-way sync)

## â±ï¸ Time Required
- 5 minutes in Supabase SQL Editor

## ğŸ¯ Impact
Once completed:
- âœ… Workflow creation will work
- âœ… Webhook URLs can be stored
- âœ… 2-way sync can be implemented
- âœ… Performance will be optimized with indexes